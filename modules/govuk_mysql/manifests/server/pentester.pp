# == Class: govuk_mysql::server::pentester
#
# Class to control the pentester user for mysql.
#
# === Parameters
#
# [*mysql_pentester*]
#   A password for the pentester user
#
class govuk_mysql::server::pentester (
  $enabled = false,
  $mysql_pentester = '',
){
  $ensure = $enabled ? {
    true  => 'present',
    false => 'absent',
  }

  govuk_mysql::user { 'pentester@localhost':
    ensure        => $ensure,
    password_hash => mysql_password($mysql_pentester),
    table         => '*.*',
    privileges    => 'ALL',
  }
}
